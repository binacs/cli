package util

import (
	"crypto/x509"
	"encoding/pem"
	"log"
)

var crtBytes = []byte(`-----BEGIN CERTIFICATE-----
MIIEpDCCA4ygAwIBAgIUSiw3JgKv63jDZOYvUFp9xnnDbvIwDQYJKoZIhvcNAQEL
BQAwgYsxCzAJBgNVBAYTAlVTMRkwFwYDVQQKExBDbG91ZEZsYXJlLCBJbmMuMTQw
MgYDVQQLEytDbG91ZEZsYXJlIE9yaWdpbiBTU0wgQ2VydGlmaWNhdGUgQXV0aG9y
aXR5MRYwFAYDVQQHEw1TYW4gRnJhbmNpc2NvMRMwEQYDVQQIEwpDYWxpZm9ybmlh
MB4XDTI0MDMwMzEzMDMwMFoXDTM5MDIyODEzMDMwMFowYjEZMBcGA1UEChMQQ2xv
dWRGbGFyZSwgSW5jLjEdMBsGA1UECxMUQ2xvdWRGbGFyZSBPcmlnaW4gQ0ExJjAk
BgNVBAMTHUNsb3VkRmxhcmUgT3JpZ2luIENlcnRpZmljYXRlMIIBIjANBgkqhkiG
9w0BAQEFAAOCAQ8AMIIBCgKCAQEA4wRRVFTK9O9pYVy33mpoHbdPUGf0U3jVZVXt
sLHFK3g8bpgYxplBdZdgim3zJJP6NefnwXa/+KvdXoutmxtbSvIyxNRb0rnd7Um8
4W1a3cUkzqBo9U3JivKUoj6R9VCV5eXctzNA0pqxgmWgWPchMV9kpyT8Ybf6kRJd
fk9FC6LiE9kPI/PbTfGa/vxt4sSGMk8yne+k5MR0C5o31H6YwXm1f1VFpRrgT39Q
8mPLiTXa14jA6fXM0mvl6if3WnDyctmxkaiTfwR4AoUhGJNrpNUzmrMzFAIw7vvq
9TR6cnis7vQREiUfzBPHpR7mNE672Ph/9NsaAqOkK29lofJqkwIDAQABo4IBJjCC
ASIwDgYDVR0PAQH/BAQDAgWgMB0GA1UdJQQWMBQGCCsGAQUFBwMCBggrBgEFBQcD
ATAMBgNVHRMBAf8EAjAAMB0GA1UdDgQWBBRnigwcFKMaXOB+vO7d6EGYDPqKMTAf
BgNVHSMEGDAWgBQk6FNXXXw0QIep65TbuuEWePwppDBABggrBgEFBQcBAQQ0MDIw
MAYIKwYBBQUHMAGGJGh0dHA6Ly9vY3NwLmNsb3VkZmxhcmUuY29tL29yaWdpbl9j
YTAnBgNVHREEIDAegg4qLmJpbmFjcy5zcGFjZYIMYmluYWNzLnNwYWNlMDgGA1Ud
HwQxMC8wLaAroCmGJ2h0dHA6Ly9jcmwuY2xvdWRmbGFyZS5jb20vb3JpZ2luX2Nh
LmNybDANBgkqhkiG9w0BAQsFAAOCAQEAJ5FymXR1oo9njdL5JVQZgF17IM40fJD4
uEEgRYiZbCLRPkTjRTdec3X66DCTWF9RyzQZtX45YjrAXVF0jDUkAsAzeV+68wKQ
E0rFCDlISbLhV/+w+gT9FUlCgDKfl9go5EX7TxKilBzSMYtNI/edGngIN/9Lr6H6
YEDAHbNleD+StqaR8NvhCuAK9vikfqJoJ4p5xguZpxK1LbEQu/MbhVMwwj7oaU+o
ylqYyJg2f4NwMaMMgBcT3TWtk/nP8VjdLW04mJMoyfzrTTtUZTGIiSFTMyTDZYdh
uXY1VS2+wb8oDYzPGM0KfvFtl06Y22Uw+KN4KTCu9q3FT0URIqxLQw==
-----END CERTIFICATE-----
`)

func GetCertPool() *x509.CertPool {
	certDERBlock, _ := pem.Decode(crtBytes)
	if certDERBlock == nil {
		log.Fatal("pem.Decode get nil")
	}
	crt, err := x509.ParseCertificate(certDERBlock.Bytes)
	if err != nil {
		log.Fatal(err)
	}
	cp := x509.NewCertPool()
	cp.AddCert(crt)
	return cp
}
