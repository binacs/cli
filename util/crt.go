package util

import (
	"crypto/x509"
	"encoding/pem"
	"log"
)

var crtBytes = []byte(`-----BEGIN CERTIFICATE-----
MIIEnjCCA4agAwIBAgIUNawqIELSy2b/8Z0cLov+rsvX3s0wDQYJKoZIhvcNAQEL
BQAwgYsxCzAJBgNVBAYTAlVTMRkwFwYDVQQKExBDbG91ZEZsYXJlLCBJbmMuMTQw
MgYDVQQLEytDbG91ZEZsYXJlIE9yaWdpbiBTU0wgQ2VydGlmaWNhdGUgQXV0aG9y
aXR5MRYwFAYDVQQHEw1TYW4gRnJhbmNpc2NvMRMwEQYDVQQIEwpDYWxpZm9ybmlh
MB4XDTI0MDExOTE0MTQwMFoXDTM5MDExNTE0MTQwMFowYjEZMBcGA1UEChMQQ2xv
dWRGbGFyZSwgSW5jLjEdMBsGA1UECxMUQ2xvdWRGbGFyZSBPcmlnaW4gQ0ExJjAk
BgNVBAMTHUNsb3VkRmxhcmUgT3JpZ2luIENlcnRpZmljYXRlMIIBIjANBgkqhkiG
9w0BAQEFAAOCAQ8AMIIBCgKCAQEAyuVhpIJHh5TcS5/w+eAHX8cr21SrXtyUmJJ9
ucrCZPRN9uWWZrJUhtF0pddJTJD018yJyfwIGDfzZ0y0R9ip7ePvTpavSLBuP4yp
p/hc6KeH44HNQ0kw2rSvFDU+hr8ZaidUv5fe8jo5v6EDr8NLUax2GVmd6N13hnaA
3SNCT48Rn8jt7zKrZzUaP5mUnGNrOZPiEWIo7vWE7B7FHYuD7CIe0qTKwfQG8SBd
6Ik2K13Qz+uHx3jRxuyRKLgMcYutDWKNkKq0S1QXt9Cf0E7rzXQ+NeXsgUX/NPkL
h/5g+Rt6fh6pAlZnkokV0+4d9D4kSKRJBW5Np+sxM/M/3CSpAQIDAQABo4IBIDCC
ARwwDgYDVR0PAQH/BAQDAgWgMB0GA1UdJQQWMBQGCCsGAQUFBwMCBggrBgEFBQcD
ATAMBgNVHRMBAf8EAjAAMB0GA1UdDgQWBBR5Ft7UknUDTp3ORm7QMnOtMonuGTAf
BgNVHSMEGDAWgBQk6FNXXXw0QIep65TbuuEWePwppDBABggrBgEFBQcBAQQ0MDIw
MAYIKwYBBQUHMAGGJGh0dHA6Ly9vY3NwLmNsb3VkZmxhcmUuY29tL29yaWdpbl9j
YTAhBgNVHREEGjAYggsqLmJpbmFjcy5jboIJYmluYWNzLmNuMDgGA1UdHwQxMC8w
LaAroCmGJ2h0dHA6Ly9jcmwuY2xvdWRmbGFyZS5jb20vb3JpZ2luX2NhLmNybDAN
BgkqhkiG9w0BAQsFAAOCAQEAPq3A7xuL0A/xtjwSKhtPfX1/34b/hhq6Vg0hrBMo
/9hROxpRmrqKZnF815Tt+gula+8mgCZGNWji4KbFJwktaQwcPvd/JAZyg+RsX5tW
kkTeOIT7LMrpk+tiFkns9HaaAUQM7Sl+m0sLNLhvpgwoHOJ9pkkjW7VEgOKmBAZ0
ekO+EV4SialytNJ3LCh6owc9dNj7UNJUrkXzAnQooqe1f5kxLoZPHsNKW/r3dKfe
k/J0849JW6czpcIJ9FUDdATQi2jMJhPGihb51oLl7tG2fFqRuKphWhcbW1HPIQG8
MZYK68HGqnCl+JQ3Itb2hgHVXZtZFkrEHv2wp8Pgv9Y7GQ==
-----END CERTIFICATE-----
`)

func GetCertPool() *x509.CertPool {
	certDERBlock, _ := pem.Decode(crtBytes)
	if certDERBlock == nil {
		log.Fatal("pem.Decode get nil")
	}
	crt, err := x509.ParseCertificate(certDERBlock.Bytes)
	if err != nil {
		log.Fatal(err)
	}
	cp := x509.NewCertPool()
	cp.AddCert(crt)
	return cp
}
