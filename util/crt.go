package util

import (
	"crypto/x509"
	"encoding/pem"
	"log"
)

var crtBytes = []byte(`-----BEGIN CERTIFICATE-----
MIIGZDCCBMygAwIBAgIRAKohKOP97DPT8Uou1TbQk48wDQYJKoZIhvcNAQEMBQAw
WTELMAkGA1UEBhMCQ04xJTAjBgNVBAoTHFRydXN0QXNpYSBUZWNobm9sb2dpZXMs
IEluYy4xIzAhBgNVBAMTGlRydXN0QXNpYSBSU0EgRFYgVExTIENBIEcyMB4XDTIz
MDEyODAwMDAwMFoXDTI0MDEyODIzNTk1OVowGDEWMBQGA1UEAxMNYXBpLmJpbmFj
cy5jbjCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBANFoFZG/YrMg5h1b
w3rsoWBUk+jfAGeUttuq8VKf7bYHewXQRrbl227kjnIo0DM+m4dlSiYpfTBXeQti
SAEJXbOympvguakw81sCNeNBgn+sB8d3S9EpoFFUugaKvBvaqj+U/jF70ul57jxb
L7pdDg01xH2ZmEa/l0ah55pF0yghz8im4bPp+mzs7e+4EhFMKDCEnnheEreSp7J/
q1VsBzx0g3cLOiVMeEp4KZv1cXmVrbw2PIMbBcO0fVOfClksKjXCl97NjByu/dhq
QB0bwkcSA5pmYsZxJneB9daU11yt4CwKEw/3GI28z3cvT8D6tTMqIab0MBntT1h/
UNSUtHUCAwEAAaOCAuYwggLiMB8GA1UdIwQYMBaAFF86fBEQfgxncWHci6O1AANn
9VccMB0GA1UdDgQWBBRt+MOx+wKpVFfKriGS1fWbczI1DTAOBgNVHQ8BAf8EBAMC
BaAwDAYDVR0TAQH/BAIwADAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIw
SQYDVR0gBEIwQDA0BgsrBgEEAbIxAQICMTAlMCMGCCsGAQUFBwIBFhdodHRwczov
L3NlY3RpZ28uY29tL0NQUzAIBgZngQwBAgEwfQYIKwYBBQUHAQEEcTBvMEIGCCsG
AQUFBzAChjZodHRwOi8vY3J0LnRydXN0LXByb3ZpZGVyLmNuL1RydXN0QXNpYVJT
QURWVExTQ0FHMi5jcnQwKQYIKwYBBQUHMAGGHWh0dHA6Ly9vY3NwLnRydXN0LXBy
b3ZpZGVyLmNuMBgGA1UdEQQRMA+CDWFwaS5iaW5hY3MuY24wggF9BgorBgEEAdZ5
AgQCBIIBbQSCAWkBZwB1AHb/iD8KtvuVUcJhzPWHujS0pM27KdxoQgqf5mdMWjp0
AAABhfj2pTQAAAQDAEYwRAIgHcorOa3pxfL0bBNeTL460q/VxNNczkPIwu3VvkSm
ObQCIAvjHL75nZ2ypnkbvjTClDqGto8Dql9t6GOwLZsSq2RbAHUA2ra/az+1tiKf
m8K7XGvocJFxbLtRhIU0vaQ9MEjX+6sAAAGF+PalQAAABAMARjBEAiB+PDLvj8Ir
z5Amb/lflaEfdXFGMEaE57EjWr8CJ1hMRgIgOcCN2ca29zLoHgcBASEywmbMv1RE
BA1WaBq8OCW44XsAdwDuzdBk1dsazsVct520zROiModGfLzs3sNRSFlGcR+1mwAA
AYX49qUWAAAEAwBIMEYCIQDgV+g9aj8j1JIJCtpx30SUO5B9JkSkEdAANMS7gs7i
7gIhALnOY9EqRoZ4uP9DBt9BKl8A96EkThBgyeWApf8aEDmmMA0GCSqGSIb3DQEB
DAUAA4IBgQBzHRe2qULCTON1l/UrsM6h+tZ2fwZvzQqjawUUYSkjYkH0Va/qAY3z
StKCKeEVNq8E+jvvt5xCk1B9c5sAWeMUXhZrY22/Iv/dzzpLiEo6LF8WJg8fW5H9
rAT98UvXhEgBFq/Rtugp79v3j0lFamnJHFdsMc+YaT7S+2ixdhot2FDWlBYTzST3
k1oROMasl7F5PJDoa45G1KLE6xkp+vm+v3ohD6HNU8//9QMvC8vbRfr4huX7VA1i
p6E3c+uvX2/pArfCv8rSF6hr3m/xoevheFnSlREXSQDBcXj9vkwqFeDXdGB5cDSk
l69LO8Bk1hvSfP9rIBZlu3quVCSCNy9k/ciFFlpvp8ZTdgUpji3MRjWKzGuKyH0u
WFicAUJka/+bZcX3jRaAnib1BX+DTwAgv1sneWNyy8M3QSMP3UJEnetQc8iLCVWe
DYoLz34P1z29+oGNY/50dzdh9cbDzZfyYE9V0F2BH/yK7nmjrRzDR0Rw2ArXQnwF
lChSJi0umOY=
-----END CERTIFICATE-----
`)

func GetCertPool() *x509.CertPool {
	certDERBlock, _ := pem.Decode(crtBytes)
	if certDERBlock == nil {
		log.Fatal("pem.Decode get nil")
	}
	crt, err := x509.ParseCertificate(certDERBlock.Bytes)
	if err != nil {
		log.Fatal(err)
	}
	cp := x509.NewCertPool()
	cp.AddCert(crt)
	return cp
}
